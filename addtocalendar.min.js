angular.module("jshor.angular-addtocalendar",[]).controller("AddtocalendarCtrl",function(e){var a=ics();e.description=e.description||"",e.getIcsCalendarUrl=function(){return a.addEvent(e.title,e.description,e.location,e.startDate,e.endDate),a.download()};var t=function(){var a="http://calendar.yahoo.com/?v=60&view=d&type=20";return a+="&title="+encodeURI(e.title),a+="&st="+encodeURI(e.startDate)+"&et="+encodeURI(e.endDate),a+="&desc="+encodeURI(e.description),a+="&in_loc="+encodeURI(e.location)},n=function(){var a="https://www.google.com/calendar/render?action=TEMPLATE";return a+="&text="+encodeURI(e.title),a+="&dates="+encodeURI(e.startDate)+"/"+encodeURI(e.endDate),a+="&details="+encodeURI(e.description),a+="&location="+encodeURI(e.location)},o=function(){var a="http://calendar.live.com/calendar/calendar.aspx?rru=addevent";return a+="&summary="+encodeURI(e.title),a+="&dtstart="+encodeURI(e.startDate)+"&dtend="+encodeURI(e.endDate),a+="&description="+encodeURI(e.description),a+="&location="+encodeURI(e.location)};e.calendarUrl={microsoft:o(),google:n(),yahoo:t()}}).directive("addtocalendar",function(){return{restrict:"E",scope:{startDate:"@",endDate:"@",title:"@",description:"@",location:"@",className:"@"},controller:"AddtocalendarCtrl",template:'<div class="dropdown"><button ng-class="className || \'btn btn-sm btn-default dropdown-toggle\'" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Add to Calendar<span class="caret"></span></button><ul class="dropdown-menu"><li><a href="#" ng-click="getIcsCalendarUrl()">iCalendar</a></li><li><a href="{{calendarUrl.google}}" target="_blank">Google Calendar</a></li><li><a href="#" ng-click="getIcsCalendarUrl()">Outlook</a></li><li><a href="{{calendarUrl.yahoo}}" target="_blank">Yahoo! Calendar</a></li><li><a href="{{calendarUrl.microsoft}}" target="_blank">Microsoft Calendar</a></li></ul></div>'}});