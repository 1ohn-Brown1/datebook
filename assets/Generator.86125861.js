var H=Object.defineProperty;var x=(e,s,t)=>s in e?H(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var a=(e,s,t)=>(x(e,typeof s!="symbol"?s+"":s,t),t);import K from"./ConfigObject.1e03fe71.js";import q from"./Basics.4cc54ffb.js";import Q from"./Dates.dadc5f91.js";import W from"./Recurrence.f934db49.js";import{f as Z,g as S,h as I,_ as X,r as v,o as P,c as Y,e as U,i as $,v as j,b as d,j as z,k as J,F as tt,l as et,d as b,t as k}from"./app.c40d39d3.js";import"./Months.9fe2b338.js";import"./Nth.cab37520.js";import"./Plural.f0c39a92.js";import"./Row.d6324f7d.js";import"./Weekdays.0feda226.js";const st={FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"}},h={DATE:"YYYYMMDD",TIME:"ThhmmssZ",FULL:"YYYYMMDDThhmmssZ",NO_UTC_FULL:"YYYYMMDDThhmmss",OUTLOOK_DATE:"YYYY-MM-DD",OUTLOOK_TIME:"Thh:mm:ssZ",OUTLOOK_FULL:"YYYY-MM-DDThh:mm:ssZ"},O={YAHOO:"https://calendar.yahoo.com/",GOOGLE:"https://calendar.google.com/calendar/render",OUTLOOK:"https://outlook.{{host}}.com/calendar/0/deeplink/compose"},p=(e="")=>`0${parseInt(e.toString(),10)}`.slice(-2),nt=(e,s)=>{const t=Math.floor((s-e)/1e3),n=Math.floor(t/3600),r=t/3600%1*60;return`${p(n)}${p(r)}`},rt=(e,s)=>{const t=Math.floor((s-e)/1e3);return Math.floor(t/3600)},at=e=>{const{frequency:s,interval:t}=e,{FREQUENCY:n}=st;if(t)switch(s){case n.YEARLY:return t*365.25;case n.MONTHLY:return t*30.42;case n.WEEKLY:return t*7;default:return t}return 365.25*100},F=(e=new Date,s)=>{const t={YYYY:e.getUTCFullYear(),MM:p(e.getUTCMonth()+1),DD:p(e.getUTCDate()),hh:p(e.getUTCHours()),mm:p(e.getUTCMinutes()),ss:p(e.getUTCSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},ot=(e=new Date,s)=>{const t={YYYY:e.getFullYear(),MM:p(e.getMonth()+1),DD:p(e.getDate()),hh:p(e.getHours()),mm:p(e.getMinutes()),ss:p(e.getSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},it=()=>F(new Date,h.DATE),lt=(e,s)=>{const t=s*864e5,n=new Date;return n.setTime(e.getTime()+t),n},u={addLeadingZero:p,getDuration:nt,getHoursDiff:rt,getRecurrenceLengthDays:at,formatDate:F,formatDateNoUtc:ot,getTimeCreated:it,incrementDate:lt};class R{constructor(s){a(this,"isAllDay",!1);a(this,"description","");a(this,"title","");a(this,"location","");a(this,"start",new Date);a(this,"end",new Date);a(this,"recurrence");a(this,"params",{});a(this,"attendees",[]);a(this,"setText",s=>{this.description=s.description||"",this.title=s.title||"",this.location=s.location||""});a(this,"setTimestamps",s=>{this.isAllDay=!s.end,this.start=s.start,this.end=s.end||u.incrementDate(this.start,1),this.recurrence=s.recurrence});a(this,"setParam",(s,t)=>(this.params[s]=t,this));this.setText(s),this.setTimestamps(s),this.setAttendees(s)}setAttendees(s){this.attendees=Array.isArray(s.attendees)?s.attendees:[]}}const C=(e,s=";",t=n=>n)=>{const n=[];for(const r in e)e.hasOwnProperty(r)&&e[r]!==void 0&&n.push(`${r}=${t(e[r])}`);return n.join(s)},ct=e=>{const s=Object.keys(e).filter(t=>e[t]!==null).reduce((t,n)=>({...t,[n]:e[n]}),{});return C(s,"&",encodeURIComponent)},dt=e=>C(e,";"),ut=e=>e.map(({email:s,name:t})=>t?`${t} <${s}>`:s),mt=e=>[e[0].toUpperCase(),e.slice(-e.length+1).toLowerCase()].join(""),E={toParamString:C,toQueryString:ct,toIcsParamString:dt,toMailtoList:ut,toProperCase:mt};var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},V={exports:{}};(function(e,s){(function(t,n){n()})(L,function(){function t(o,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function n(o,i,c){var l=new XMLHttpRequest;l.open("GET",o),l.responseType="blob",l.onload=function(){D(l.response,i,c)},l.onerror=function(){console.error("could not download file")},l.send()}function r(o){var i=new XMLHttpRequest;i.open("HEAD",o,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function T(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}}var m=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof L=="object"&&L.global===L?L:void 0,y=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),D=m.saveAs||(typeof window!="object"||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(o,i,c){var l=m.URL||m.webkitURL,f=document.createElement("a");i=i||o.name||"download",f.download=i,f.rel="noopener",typeof o=="string"?(f.href=o,f.origin===location.origin?T(f):r(f.href)?n(o,i,c):T(f,f.target="_blank")):(f.href=l.createObjectURL(o),setTimeout(function(){l.revokeObjectURL(f.href)},4e4),setTimeout(function(){T(f)},0))}:"msSaveOrOpenBlob"in navigator?function(o,i,c){if(i=i||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(t(o,c),i);else if(r(o))n(o,i,c);else{var l=document.createElement("a");l.href=o,l.target="_blank",setTimeout(function(){T(l)})}}:function(o,i,c,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof o=="string")return n(o,i,c);var f=o.type==="application/octet-stream",G=/constructor/i.test(m.HTMLElement)||m.safari,N=/CriOS\/[\d]+/.test(navigator.userAgent);if((N||f&&G||y)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var A=w.result;A=N?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=A:location=A,l=null},w.readAsDataURL(o)}else{var _=m.URL||m.webkitURL,M=_.createObjectURL(o);l?l.location=M:location.href=M,l=null,setTimeout(function(){_.revokeObjectURL(M)},4e4)}});m.saveAs=D.saveAs=D,e.exports=D})})(V);const ht=(e,s)=>{const t=document.createElement("a"),n=encodeURIComponent(e);if(t.setAttribute("href",`data:text/calendar;charset=utf-8,${n}`),t.setAttribute("download",s),document.createEvent){const r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),t.dispatchEvent(r)}else t.click()},ft=(e="")=>e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/[,;]/g,"\\$&"),B=e=>new Blob([e],{type:"application/octet-stream"}),pt=e=>e?`${e.replace(/[^\w ]/g,"")}.ics`:"event.ics",Tt=()=>Math.random().toString(36).substr(2),gt=()=>typeof window<"u"?window.location.host:"datebook",Dt=e=>{var t,n;const s={FREQ:e.frequency,INTERVAL:(t=e.interval)==null?void 0:t.toString(),COUNT:(n=e.count)==null?void 0:n.toString(),WKST:e.weekstart,BYDAY:e.weekdays,BYMONTHDAY:e.monthdays};return e.end&&(s.UNTIL=u.formatDate(e.end,h.FULL)),E.toIcsParamString(s)},Et=()=>window.hasOwnProperty("safari")||/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&!/(cr|fx)ios[^a-z]/i.test(navigator.userAgent),yt=(e,s)=>{if(Et())ht(s,e);else{const t=B(s);V.exports.saveAs(t,e)}},g={formatText:ft,getBlob:B,getFileName:pt,getUid:Tt,getProdId:gt,getRrule:Dt,download:yt};class At extends R{constructor(t){super(t);a(this,"setInitialParams",()=>{let t=h.DATE;this.isAllDay||(t+=h.TIME);const n=[u.formatDate(this.start,t),u.formatDate(this.end,t)].join("/");this.setParam("action","TEMPLATE").setParam("dates",n).setParam("text",this.title).setParam("details",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.recurrence&&this.setParam("recur",`RRULE:${g.getRrule(this.recurrence)}`),this.attendees.length>0&&this.setParam("add",E.toMailtoList(this.attendees).join(","))});a(this,"render",()=>{const t=O.GOOGLE,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class vt extends R{constructor(t){super(t);a(this,"setInitialParams",()=>{this.setParam("v","60").setParam("title",this.title).setParam("desc",this.description).setParam("in_loc",this.location),this.setTimeParams(),this.attendees.length>0&&this.setParam("inv_list",E.toMailtoList(this.attendees).join(","))});a(this,"setTimeParams",()=>{this.isAllDay?this.setParam("dur","allday").setParam("st",u.formatDateNoUtc(this.start,h.DATE)):(this.setParam("st",u.formatDateNoUtc(this.start,h.NO_UTC_FULL)),u.getHoursDiff(this.start.getTime(),this.end.getTime())>99?this.setParam("et",u.formatDateNoUtc(this.end,h.NO_UTC_FULL)):this.setParam("dur",u.getDuration(this.start.getTime(),this.end.getTime())))});a(this,"render",()=>{const t=O.YAHOO,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class Lt extends R{constructor(t){super(t);a(this,"baseUrl",O.OUTLOOK);a(this,"setInitialParams",()=>{let t=h.OUTLOOK_DATE;this.isAllDay||(t+=h.OUTLOOK_TIME),this.setParam("rru","addevent").setParam("path","/calendar/action/compose").setParam("startdt",u.formatDate(this.start,t)).setParam("enddt",u.formatDate(this.end,t)).setParam("subject",this.title).setParam("body",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.attendees.length>0&&this.setParam("to",E.toMailtoList(this.attendees).join(","))});a(this,"setHost",t=>(["live","office"].includes(t)&&(this.baseUrl=O.OUTLOOK.replace("{{host}}",t)),this));a(this,"render",()=>{const t=E.toQueryString(this.params);return`${this.baseUrl}?${t}`});this.setInitialParams(),this.setHost("live")}}class Pt extends R{constructor(t){super(t);a(this,"additionalEvents",[]);a(this,"properties",[]);a(this,"meta",{});a(this,"setInitialParams",()=>{this.setMeta("UID",g.getUid()).setMeta("DTSTAMP",u.getTimeCreated()).setMeta("PRODID",g.getProdId()).addProperty("CLASS","PUBLIC").addProperty("DESCRIPTION",g.formatText(this.description)).addProperty("LOCATION",g.formatText(this.location)).addProperty("SUMMARY",g.formatText(this.title)).addProperty("TRANSP","TRANSPARENT"),this.isAllDay?this.addProperty("DTSTART;VALUE=DATE",u.formatDateNoUtc(this.start,h.DATE)).addProperty("DTEND;VALUE=DATE",u.formatDateNoUtc(u.incrementDate(this.start,1),h.DATE)):this.addProperty("DTSTART",u.formatDate(this.start,h.FULL)).addProperty("DTEND",u.formatDate(this.end,h.FULL)),this.recurrence&&this.addProperty("RRULE",g.getRrule(this.recurrence)),this.attendees.length>0&&this.attendees.forEach(({email:t,name:n,icsOptions:r={}})=>{const T=this.getAttendeeParams(r,n),m=`MAILTO:${t}`;this.addProperty(T,m)})});a(this,"getAttendeeParams",(t,n)=>{const r={};return n&&(r.CN=n),t.delegatedFrom&&(r["DELEGATED-FROM"]=t.delegatedFrom),t.partStat&&(r.PARTSTAT=t.partStat),t.role&&(r.ROLE=t.role),t.sentBy&&(r["SENT-BY"]=t.sentBy),r.RSVP=t.rsvp?"TRUE":"FALSE",`ATTENDEE;${E.toParamString(r,";")}`});a(this,"getAlarmDuration",t=>{const n=[`${t.weeks}W`,`${t.days}D`,`${t.hours}H`,`${t.minutes}M`,`${t.seconds}S`].filter(r=>/^[0-9]+[A-Z]$/.exec(r));return n.unshift(t.after?"PT":"-PT"),n.join("")});a(this,"setMeta",(t,n)=>(this.meta[t]=n,this));a(this,"addEvent",t=>(this.additionalEvents.push(t),this));a(this,"addProperty",(t,n)=>{if(typeof n=="object"){this.properties.push(`BEGIN:${t}`);for(const r in n)this.addProperty(r,n[r]);this.properties.push(`END:${t}`)}else this.properties.push(`${t}:${n.toString()}`);return this});a(this,"addAlarm",t=>{const n={ACTION:t.action};if(t.description&&(n.DESCRIPTION=g.formatText(t.description)),t.summary&&(n.SUMMARY=g.formatText(t.summary)),t.duration&&(n.DURATION=this.getAlarmDuration(t.duration)),t.repeat&&(n.REPEAT=t.repeat),t.attach){const r=t.attach.params?`ATTACH;${t.attach.params}`:"ATTACH";n[r]=t.attach.url}return t.trigger instanceof Date?n["TRIGGER;VALUE=DATE-TIME"]=u.formatDate(t.trigger,h.FULL):n.TRIGGER=this.getAlarmDuration(t.trigger),this.addProperty("VALARM",n)});a(this,"download",t=>{g.download(t||g.getFileName(this.title),this.render())});a(this,"render",()=>{const t=this.additionalEvents.concat(this).reduce((r,T)=>[...r,"BEGIN:VEVENT",...T.properties,"END:VEVENT"],[]),n=Object.keys(this.meta).map(r=>`${r}:${this.meta[r]}`);return["BEGIN:VCALENDAR","VERSION:2.0",...t,"END:VCALENDAR",...n].join(`
`)});this.setInitialParams()}}const Ut=Z({name:"Generator",components:{ConfigObject:K,Basics:q,Dates:Q,Recurrence:W},setup(){const e=S({start:new Date,location:"",title:"",description:"",recurrence:{}}),s=S(!0),t=S(!0),n={Google:At,"Yahoo!":vt,Outlook:Lt},r=I(()=>Object.keys(n).reduce((y,D)=>({...y,[D]:new n[D](e.value).render()}),{})),T=I(()=>new Pt(e.value));function m(){e.value.recurrence=t.value?{}:void 0}return{allday:s,isRecurring:t,model:e,serviceUrls:r,ics:T,onRecurrenceChange:m}}});const Ot=d("h2",null,"Event Details",-1),Rt=d("label",{for:"allday"},"This is an all-day event",-1),wt=d("h2",null,"Recurrence",-1),Mt=d("label",{for:"recurs"},"This event repeats",-1),St=d("h2",null,"Result",-1),Yt=d("h3",null,"Calendar Service Links",-1),bt=["href"],Ct=d("hr",null,null,-1),Nt=d("h3",null,"iCalendar",-1),_t=d("code",null,".ics",-1),It={class:"language-typescript"},$t={class:"language-json"},jt=d("hr",null,null,-1),kt=d("h3",null,"Datebook Config Object",-1);function Ft(e,s,t,n,r,T){const m=v("basics"),y=v("dates"),D=v("recurrence"),o=v("external-link-icon"),i=v("config-object");return P(),Y("div",null,[Ot,U(m,{modelValue:e.model,"onUpdate:modelValue":s[0]||(s[0]=c=>e.model=c)},null,8,["modelValue"]),U(y,{modelValue:e.model,"onUpdate:modelValue":s[1]||(s[1]=c=>e.model=c),allday:e.allday},null,8,["modelValue","allday"]),$(d("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>e.allday=c),type:"checkbox",id:"allday",value:"true"},null,512),[[j,e.allday]]),Rt,d("div",null,[wt,$(d("input",{"onUpdate:modelValue":s[3]||(s[3]=c=>e.isRecurring=c),type:"checkbox",id:"recurs",onChange:s[4]||(s[4]=(...c)=>e.onRecurrenceChange&&e.onRecurrenceChange(...c))},null,544),[[j,e.isRecurring]]),Mt]),e.model.recurrence?(P(),z(D,{key:0,modelValue:e.model.recurrence,"onUpdate:modelValue":s[5]||(s[5]=c=>e.model.recurrence=c),allday:e.allday},null,8,["modelValue","allday"])):J("v-if",!0),St,d("div",null,[Yt,d("ul",null,[(P(!0),Y(tt,null,et(e.serviceUrls,(c,l)=>(P(),Y("li",{key:l},[d("a",{href:c,target:"_blank"},[b(k(l)+" Calendar ",1),U(o)],8,bt)]))),128))])]),Ct,d("div",null,[Nt,d("a",{onClick:s[6]||(s[6]=c=>e.ics.download())},[b(" Download "),_t,b(" file ↓ ")]),d("div",It,[d("pre",$t,k(e.ics.render()),1)])]),jt,d("div",null,[kt,U(i,{value:e.model},null,8,["value"])])])}const zt=X(Ut,[["render",Ft],["__file","Generator.vue"]]);export{zt as default};
