var H=Object.defineProperty;var x=(t,s,e)=>s in t?H(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var a=(t,s,e)=>(x(t,typeof s!="symbol"?s+"":s,e),e);import K from"./ConfigObject.b4a17ac5.js";import q from"./Basics.25820b65.js";import Q from"./Dates.10fdbf8d.js";import W from"./Recurrence.4ee077b9.js";import{f as Z,g as S,h as j,_ as X,r as v,o as P,c as Y,e as U,i as $,v as F,b as d,j as z,k as J,F as ee,l as te,d as b,t as k}from"./app.e707df6d.js";import"./Months.9c31867d.js";import"./Nth.0f643cdf.js";import"./Plural.70b065e6.js";import"./Row.5451dfe0.js";import"./Weekdays.60f00f1a.js";var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},C={exports:{}};(function(t,s){(function(e,n){n()})(L,function(){function e(o,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function n(o,i,c){var l=new XMLHttpRequest;l.open("GET",o),l.responseType="blob",l.onload=function(){D(l.response,i,c)},l.onerror=function(){console.error("could not download file")},l.send()}function r(o){var i=new XMLHttpRequest;i.open("HEAD",o,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function h(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}}var m=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof L=="object"&&L.global===L?L:void 0,A=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),D=m.saveAs||(typeof window!="object"||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!A?function(o,i,c){var l=m.URL||m.webkitURL,p=document.createElement("a");i=i||o.name||"download",p.download=i,p.rel="noopener",typeof o=="string"?(p.href=o,p.origin===location.origin?h(p):r(p.href)?n(o,i,c):h(p,p.target="_blank")):(p.href=l.createObjectURL(o),setTimeout(function(){l.revokeObjectURL(p.href)},4e4),setTimeout(function(){h(p)},0))}:"msSaveOrOpenBlob"in navigator?function(o,i,c){if(i=i||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(e(o,c),i);else if(r(o))n(o,i,c);else{var l=document.createElement("a");l.href=o,l.target="_blank",setTimeout(function(){h(l)})}}:function(o,i,c,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof o=="string")return n(o,i,c);var p=o.type==="application/octet-stream",G=/constructor/i.test(m.HTMLElement)||m.safari,I=/CriOS\/[\d]+/.test(navigator.userAgent);if((I||p&&G||A)&&typeof FileReader<"u"){var R=new FileReader;R.onloadend=function(){var y=R.result;y=I?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=y:location=y,l=null},R.readAsDataURL(o)}else{var _=m.URL||m.webkitURL,M=_.createObjectURL(o);l?l.location=M:location.href=M,l=null,setTimeout(function(){_.revokeObjectURL(M)},4e4)}});m.saveAs=D.saveAs=D,t.exports=D})})(C);const se={FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"}},f={DATE:"YYYYMMDD",TIME:"ThhmmssZ",FULL:"YYYYMMDDThhmmssZ",NO_UTC_FULL:"YYYYMMDDThhmmss",OUTLOOK_DATE:"YYYY-MM-DD",OUTLOOK_TIME:"Thh:mm:ssZ",OUTLOOK_FULL:"YYYY-MM-DDThh:mm:ssZ"},w={YAHOO:"https://calendar.yahoo.com/",GOOGLE:"https://calendar.google.com/calendar/render",OUTLOOK:"https://outlook.{{host}}.com/calendar/0/deeplink/compose"},T=(t="")=>`0${parseInt(t.toString(),10)}`.slice(-2),ne=(t,s)=>{const e=Math.floor((s-t)/1e3),n=Math.floor(e/3600),r=e/3600%1*60;return`${T(n)}${T(r)}`},re=(t,s)=>{const e=Math.floor((s-t)/1e3);return Math.floor(e/3600)},oe=t=>{const{frequency:s,interval:e}=t,{FREQUENCY:n}=se;if(e)switch(s){case n.YEARLY:return e*365.25;case n.MONTHLY:return e*30.42;case n.WEEKLY:return e*7;default:return e}return 365.25*100},V=(t=new Date,s)=>{const e={YYYY:t.getUTCFullYear(),MM:T(t.getUTCMonth()+1),DD:T(t.getUTCDate()),hh:T(t.getUTCHours()),mm:T(t.getUTCMinutes()),ss:T(t.getUTCSeconds())};return Object.keys(e).reduce((n,r)=>n.replace(r,e[r].toString()),s)},ae=(t=new Date,s)=>{const e={YYYY:t.getFullYear(),MM:T(t.getMonth()+1),DD:T(t.getDate()),hh:T(t.getHours()),mm:T(t.getMinutes()),ss:T(t.getSeconds())};return Object.keys(e).reduce((n,r)=>n.replace(r,e[r].toString()),s)},ie=()=>V(new Date,f.FULL),le=(t,s)=>{const e=s*864e5,n=new Date;return n.setTime(t.getTime()+e),n},u={addLeadingZero:T,getDuration:ne,getHoursDiff:re,getRecurrenceLengthDays:oe,formatDate:V,formatDateNoUtc:ae,getTimeCreated:ie,incrementDate:le};class O{constructor(s){a(this,"isAllDay",!1);a(this,"description","");a(this,"title","");a(this,"location","");a(this,"start",new Date);a(this,"end",new Date);a(this,"recurrence");a(this,"params",{});a(this,"attendees",[]);a(this,"setText",s=>{this.description=s.description||"",this.title=s.title||"",this.location=s.location||""});a(this,"setTimestamps",s=>{this.isAllDay=!s.end,this.start=s.start,this.end=s.end||u.incrementDate(this.start,1),this.recurrence=s.recurrence});a(this,"setParam",(s,e)=>(this.params[s]=e,this));this.setText(s),this.setTimestamps(s),this.setAttendees(s)}setAttendees(s){this.attendees=Array.isArray(s.attendees)?s.attendees:[]}}const N=(t,s=";",e=n=>n)=>{const n=[];for(const r in t)t.hasOwnProperty(r)&&t[r]!==void 0&&n.push(`${r}=${e(t[r])}`);return n.join(s)},ce=t=>{const s=Object.keys(t).filter(e=>t[e]!==null).reduce((e,n)=>({...e,[n]:t[n]}),{});return N(s,"&",encodeURIComponent)},de=t=>N(t,";"),ue=t=>t.map(({email:s,name:e})=>e?`${e} <${s}>`:s),me=t=>[t[0].toUpperCase(),t.slice(-t.length+1).toLowerCase()].join(""),E={toParamString:N,toQueryString:ce,toIcsParamString:de,toMailtoList:ue,toProperCase:me},he=(t="")=>t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/[,;]/g,"\\$&"),B=t=>new Blob([t],{type:"application/octet-stream"}),fe=t=>t?`${t.replace(/[^\w ]/g,"")}.ics`:"event.ics",pe=()=>Math.random().toString(36).substr(2),Te=()=>typeof window<"u"?window.location.host:"datebook",ge=t=>{var e,n;const s={FREQ:t.frequency,INTERVAL:(e=t.interval)==null?void 0:e.toString(),COUNT:(n=t.count)==null?void 0:n.toString(),WKST:t.weekstart,BYDAY:t.weekdays,BYMONTHDAY:t.monthdays};return t.end&&(s.UNTIL=u.formatDate(t.end,f.FULL)),E.toIcsParamString(s)},De=(t,s)=>{const e=B(s);C.exports.saveAs(e,t)},g={formatText:he,getBlob:B,getFileName:fe,getUid:pe,getProdId:Te,getRrule:ge,download:De};class Ee extends O{constructor(e){super(e);a(this,"setInitialParams",()=>{let e=f.DATE;this.isAllDay||(e+=f.TIME);const n=[u.formatDate(this.start,e),u.formatDate(this.end,e)].join("/");this.setParam("action","TEMPLATE").setParam("dates",n).setParam("text",this.title).setParam("details",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.recurrence&&this.setParam("recur",`RRULE:${g.getRrule(this.recurrence)}`),this.attendees.length>0&&this.setParam("add",E.toMailtoList(this.attendees).join(","))});a(this,"render",()=>{const e=w.GOOGLE,n=E.toQueryString(this.params);return`${e}?${n}`});this.setInitialParams()}}class Ae extends O{constructor(e){super(e);a(this,"setInitialParams",()=>{this.setParam("v","60").setParam("title",this.title).setParam("desc",this.description).setParam("in_loc",this.location),this.setTimeParams(),this.attendees.length>0&&this.setParam("inv_list",E.toMailtoList(this.attendees).join(","))});a(this,"setTimeParams",()=>{this.isAllDay?this.setParam("dur","allday").setParam("st",u.formatDateNoUtc(this.start,f.DATE)):(this.setParam("st",u.formatDateNoUtc(this.start,f.NO_UTC_FULL)),u.getHoursDiff(this.start.getTime(),this.end.getTime())>99?this.setParam("et",u.formatDateNoUtc(this.end,f.NO_UTC_FULL)):this.setParam("dur",u.getDuration(this.start.getTime(),this.end.getTime())))});a(this,"render",()=>{const e=w.YAHOO,n=E.toQueryString(this.params);return`${e}?${n}`});this.setInitialParams()}}class ye extends O{constructor(e){super(e);a(this,"baseUrl",w.OUTLOOK);a(this,"setInitialParams",()=>{let e=f.OUTLOOK_DATE;this.isAllDay||(e+=f.OUTLOOK_TIME),this.setParam("rru","addevent").setParam("path","/calendar/action/compose").setParam("startdt",u.formatDate(this.start,e)).setParam("enddt",u.formatDate(this.end,e)).setParam("subject",this.title).setParam("body",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.attendees.length>0&&this.setParam("to",E.toMailtoList(this.attendees).join(","))});a(this,"setHost",e=>(["live","office"].includes(e)&&(this.baseUrl=w.OUTLOOK.replace("{{host}}",e)),this));a(this,"render",()=>{const e=E.toQueryString(this.params);return`${this.baseUrl}?${e}`});this.setInitialParams(),this.setHost("live")}}class ve extends O{constructor(e){super(e);a(this,"additionalEvents",[]);a(this,"properties",[]);a(this,"meta",{});a(this,"setInitialParams",()=>{this.setMeta("UID",g.getUid()).setMeta("DTSTAMP",u.getTimeCreated()).addProperty("CLASS","PUBLIC").addProperty("DESCRIPTION",g.formatText(this.description)).addProperty("LOCATION",g.formatText(this.location)).addProperty("SUMMARY",g.formatText(this.title)).addProperty("TRANSP","TRANSPARENT"),this.isAllDay?this.addProperty("DTSTART;VALUE=DATE",u.formatDateNoUtc(this.start,f.DATE)).addProperty("DTEND;VALUE=DATE",u.formatDateNoUtc(u.incrementDate(this.start,1),f.DATE)):this.addProperty("DTSTART",u.formatDate(this.start,f.FULL)).addProperty("DTEND",u.formatDate(this.end,f.FULL)),this.recurrence&&this.addProperty("RRULE",g.getRrule(this.recurrence)),this.attendees.length>0&&this.attendees.forEach(({email:e,name:n,icsOptions:r={}})=>{const h=this.getAttendeeParams(r,n),m=`MAILTO:${e}`;this.addProperty(h,m)})});a(this,"getAttendeeParams",(e,n)=>{const r={};return n&&(r.CN=n),e.delegatedFrom&&(r["DELEGATED-FROM"]=e.delegatedFrom),e.partStat&&(r.PARTSTAT=e.partStat),e.role&&(r.ROLE=e.role),e.sentBy&&(r["SENT-BY"]=e.sentBy),r.RSVP=e.rsvp?"TRUE":"FALSE",`ATTENDEE;${E.toParamString(r,";")}`});a(this,"getAlarmDuration",e=>{const n=[`${e.weeks}W`,`${e.days}D`,`${e.hours}H`,`${e.minutes}M`,`${e.seconds}S`].filter(r=>/^[0-9]+[A-Z]$/.exec(r));return n.unshift(e.after?"PT":"-PT"),n.join("")});a(this,"getMeta",()=>Object.keys(this.meta).map(e=>`${e}:${this.meta[e]}`));a(this,"setMeta",(e,n)=>(this.meta[e]=n,this));a(this,"addEvent",e=>(this.additionalEvents.push(e),this));a(this,"addProperty",(e,n)=>{if(typeof n=="object"){this.properties.push(`BEGIN:${e}`);for(const r in n)this.addProperty(r,n[r]);this.properties.push(`END:${e}`)}else this.properties.push(`${e}:${n.toString()}`);return this});a(this,"addAlarm",e=>{const n={ACTION:e.action};if(e.description&&(n.DESCRIPTION=g.formatText(e.description)),e.summary&&(n.SUMMARY=g.formatText(e.summary)),e.duration&&(n.DURATION=this.getAlarmDuration(e.duration)),e.repeat&&(n.REPEAT=e.repeat),e.attach){const r=e.attach.params?`ATTACH;${e.attach.params}`:"ATTACH";n[r]=e.attach.url}return e.trigger instanceof Date?n["TRIGGER;VALUE=DATE-TIME"]=u.formatDate(e.trigger,f.FULL):n.TRIGGER=this.getAlarmDuration(e.trigger),this.addProperty("VALARM",n)});a(this,"download",e=>{console.warn(["ICalendar.download() is deprecated and will be removed in the next major release.","See https://datebook.dev/api/icalendar.html#example-for-downloading-an-ics-file for more info on how to download ICS files."].join(" ")),g.download(e||g.getFileName(this.title),this.render())});a(this,"render",()=>["BEGIN:VCALENDAR","VERSION:2.0",...[this,...this.additionalEvents].reduce((r,h)=>[...r,"BEGIN:VEVENT",...h.properties,...h.getMeta(),"END:VEVENT"],[]),`PRODID:${g.getProdId()}`,"END:VCALENDAR"].join(`
`));this.setInitialParams()}}const Le=Z({name:"Generator",components:{ConfigObject:K,Basics:q,Dates:Q,Recurrence:W},setup(){const t=S({start:new Date,location:"",title:"",description:"",recurrence:{}}),s=S(!0),e=S(!0),n={Google:Ee,"Yahoo!":Ae,Outlook:ye},r=j(()=>Object.keys(n).reduce((D,o)=>({...D,[o]:new n[o](t.value).render()}),{})),h=j(()=>new ve(t.value));function m(){t.value.recurrence=e.value?{}:void 0}function A(){const D=new Blob([h.value.render()],{type:"text/calendar"});C.exports.saveAs(D,"Event.ics")}return{isAllDay:s,isRecurring:e,model:t,serviceUrls:r,ics:h,onRecurrenceChange:m,download:A}}});const Pe=d("h2",null,"Event Details",-1),Ue=d("label",{for:"isAllDay"},"This is an all-day event",-1),we=d("h2",null,"Recurrence",-1),Oe=d("label",{for:"recurs"},"This event repeats",-1),Re=d("h2",null,"Result",-1),Me=d("h3",null,"Calendar Service Links",-1),Se=["href"],Ye=d("hr",null,null,-1),be=d("h3",null,"iCalendar",-1),Ce=d("code",null,".ics",-1),Ne={class:"language-typescript"},Ie={class:"language-json"},_e=d("hr",null,null,-1),je=d("h3",null,"Datebook Config Object",-1);function $e(t,s,e,n,r,h){const m=v("basics"),A=v("dates"),D=v("recurrence"),o=v("external-link-icon"),i=v("config-object");return P(),Y("div",null,[Pe,U(m,{modelValue:t.model,"onUpdate:modelValue":s[0]||(s[0]=c=>t.model=c)},null,8,["modelValue"]),U(A,{modelValue:t.model,"onUpdate:modelValue":s[1]||(s[1]=c=>t.model=c),isAllDay:t.isAllDay},null,8,["modelValue","isAllDay"]),$(d("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>t.isAllDay=c),type:"checkbox",id:"isAllDay",value:"true"},null,512),[[F,t.isAllDay]]),Ue,d("div",null,[we,$(d("input",{"onUpdate:modelValue":s[3]||(s[3]=c=>t.isRecurring=c),type:"checkbox",id:"recurs",onChange:s[4]||(s[4]=(...c)=>t.onRecurrenceChange&&t.onRecurrenceChange(...c))},null,544),[[F,t.isRecurring]]),Oe]),t.model.recurrence?(P(),z(D,{key:0,modelValue:t.model.recurrence,"onUpdate:modelValue":s[5]||(s[5]=c=>t.model.recurrence=c),isAllDay:t.isAllDay},null,8,["modelValue","isAllDay"])):J("v-if",!0),Re,d("div",null,[Me,d("ul",null,[(P(!0),Y(ee,null,te(t.serviceUrls,(c,l)=>(P(),Y("li",{key:l},[d("a",{href:c,target:"_blank"},[b(k(l)+" Calendar ",1),U(o)],8,Se)]))),128))])]),Ye,d("div",null,[be,d("a",{onClick:s[6]||(s[6]=(...c)=>t.download&&t.download(...c))},[b(" Download "),Ce,b(" file ↓ ")]),d("div",Ne,[d("pre",Ie,k(t.ics.render()),1)])]),_e,d("div",null,[je,U(i,{value:t.model},null,8,["value"])])])}const Ze=X(Le,[["render",$e],["__file","Generator.vue"]]);export{Ze as default};
