var H=Object.defineProperty;var x=(e,s,t)=>s in e?H(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var o=(e,s,t)=>(x(e,typeof s!="symbol"?s+"":s,t),t);import K from"./ConfigObject.061dc9f5.js";import q from"./Basics.6e769c0c.js";import Q from"./Dates.8a2527dc.js";import W from"./Recurrence.d7d9152b.js";import{f as Z,g as S,h as I,_ as X,r as v,o as P,c as Y,e as U,i as $,v as j,b as d,j as z,k as J,F as tt,l as et,d as b,t as F}from"./app.be7f4ba4.js";import"./Months.f0a1cd04.js";import"./Nth.79ee4491.js";import"./Plural.794a25dd.js";import"./Row.14632722.js";import"./Weekdays.6b5ff743.js";const st={FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"}},m={DATE:"YYYYMMDD",TIME:"ThhmmssZ",FULL:"YYYYMMDDThhmmssZ",NO_UTC_FULL:"YYYYMMDDThhmmss",OUTLOOK_DATE:"YYYY-MM-DD",OUTLOOK_TIME:"Thh:mm:ssZ",OUTLOOK_FULL:"YYYY-MM-DDThh:mm:ssZ"},O={YAHOO:"https://calendar.yahoo.com/",GOOGLE:"https://calendar.google.com/calendar/render",OUTLOOK:"https://outlook.{{host}}.com/calendar/0/deeplink/compose"},g=(e="")=>`0${parseInt(e.toString(),10)}`.slice(-2),nt=(e,s)=>{const t=Math.floor((s-e)/1e3),n=Math.floor(t/3600),r=t/3600%1*60;return`${g(n)}${g(r)}`},rt=(e,s)=>{const t=Math.floor((s-e)/1e3);return Math.floor(t/3600)},ot=e=>{const{frequency:s,interval:t}=e,{FREQUENCY:n}=st;if(t)switch(s){case n.YEARLY:return t*365.25;case n.MONTHLY:return t*30.42;case n.WEEKLY:return t*7;default:return t}return 365.25*100},k=(e=new Date,s)=>{const t={YYYY:e.getUTCFullYear(),MM:g(e.getUTCMonth()+1),DD:g(e.getUTCDate()),hh:g(e.getUTCHours()),mm:g(e.getUTCMinutes()),ss:g(e.getUTCSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},at=(e=new Date,s)=>{const t={YYYY:e.getFullYear(),MM:g(e.getMonth()+1),DD:g(e.getDate()),hh:g(e.getHours()),mm:g(e.getMinutes()),ss:g(e.getSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},it=()=>k(new Date,m.FULL),lt=(e,s)=>{const t=s*864e5,n=new Date;return n.setTime(e.getTime()+t),n},u={addLeadingZero:g,getDuration:nt,getHoursDiff:rt,getRecurrenceLengthDays:ot,formatDate:k,formatDateNoUtc:at,getTimeCreated:it,incrementDate:lt};class R{constructor(s){o(this,"isAllDay",!1);o(this,"description","");o(this,"title","");o(this,"location","");o(this,"start",new Date);o(this,"end",new Date);o(this,"recurrence");o(this,"params",{});o(this,"attendees",[]);o(this,"setText",s=>{this.description=s.description||"",this.title=s.title||"",this.location=s.location||""});o(this,"setTimestamps",s=>{this.isAllDay=!s.end,this.start=s.start,this.end=s.end||u.incrementDate(this.start,1),this.recurrence=s.recurrence});o(this,"setParam",(s,t)=>(this.params[s]=t,this));this.setText(s),this.setTimestamps(s),this.setAttendees(s)}setAttendees(s){this.attendees=Array.isArray(s.attendees)?s.attendees:[]}}const C=(e,s=";",t=n=>n)=>{const n=[];for(const r in e)e.hasOwnProperty(r)&&e[r]!==void 0&&n.push(`${r}=${t(e[r])}`);return n.join(s)},ct=e=>{const s=Object.keys(e).filter(t=>e[t]!==null).reduce((t,n)=>({...t,[n]:e[n]}),{});return C(s,"&",encodeURIComponent)},dt=e=>C(e,";"),ut=e=>e.map(({email:s,name:t})=>t?`${t} <${s}>`:s),ht=e=>[e[0].toUpperCase(),e.slice(-e.length+1).toLowerCase()].join(""),E={toParamString:C,toQueryString:ct,toIcsParamString:dt,toMailtoList:ut,toProperCase:ht};var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},V={exports:{}};(function(e,s){(function(t,n){n()})(L,function(){function t(a,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function n(a,i,c){var l=new XMLHttpRequest;l.open("GET",a),l.responseType="blob",l.onload=function(){D(l.response,i,c)},l.onerror=function(){console.error("could not download file")},l.send()}function r(a){var i=new XMLHttpRequest;i.open("HEAD",a,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function f(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(i)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof L=="object"&&L.global===L?L:void 0,A=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),D=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!A?function(a,i,c){var l=h.URL||h.webkitURL,p=document.createElement("a");i=i||a.name||"download",p.download=i,p.rel="noopener",typeof a=="string"?(p.href=a,p.origin===location.origin?f(p):r(p.href)?n(a,i,c):f(p,p.target="_blank")):(p.href=l.createObjectURL(a),setTimeout(function(){l.revokeObjectURL(p.href)},4e4),setTimeout(function(){f(p)},0))}:"msSaveOrOpenBlob"in navigator?function(a,i,c){if(i=i||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(t(a,c),i);else if(r(a))n(a,i,c);else{var l=document.createElement("a");l.href=a,l.target="_blank",setTimeout(function(){f(l)})}}:function(a,i,c,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof a=="string")return n(a,i,c);var p=a.type==="application/octet-stream",G=/constructor/i.test(h.HTMLElement)||h.safari,N=/CriOS\/[\d]+/.test(navigator.userAgent);if((N||p&&G||A)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var y=w.result;y=N?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=y:location=y,l=null},w.readAsDataURL(a)}else{var _=h.URL||h.webkitURL,M=_.createObjectURL(a);l?l.location=M:location.href=M,l=null,setTimeout(function(){_.revokeObjectURL(M)},4e4)}});h.saveAs=D.saveAs=D,e.exports=D})})(V);const mt=(e,s)=>{const t=document.createElement("a"),n=encodeURIComponent(e);if(t.setAttribute("href",`data:text/calendar;charset=utf-8,${n}`),t.setAttribute("download",s),document.createEvent){const r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),t.dispatchEvent(r)}else t.click()},ft=(e="")=>e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/[,;]/g,"\\$&"),B=e=>new Blob([e],{type:"application/octet-stream"}),pt=e=>e?`${e.replace(/[^\w ]/g,"")}.ics`:"event.ics",gt=()=>Math.random().toString(36).substr(2),Tt=()=>typeof window<"u"?window.location.host:"datebook",Dt=e=>{var t,n;const s={FREQ:e.frequency,INTERVAL:(t=e.interval)==null?void 0:t.toString(),COUNT:(n=e.count)==null?void 0:n.toString(),WKST:e.weekstart,BYDAY:e.weekdays,BYMONTHDAY:e.monthdays};return e.end&&(s.UNTIL=u.formatDate(e.end,m.FULL)),E.toIcsParamString(s)},Et=()=>window.hasOwnProperty("safari")||/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&!/(cr|fx)ios[^a-z]/i.test(navigator.userAgent),At=(e,s)=>{if(Et())mt(s,e);else{const t=B(s);V.exports.saveAs(t,e)}},T={formatText:ft,getBlob:B,getFileName:pt,getUid:gt,getProdId:Tt,getRrule:Dt,download:At};class yt extends R{constructor(t){super(t);o(this,"setInitialParams",()=>{let t=m.DATE;this.isAllDay||(t+=m.TIME);const n=[u.formatDate(this.start,t),u.formatDate(this.end,t)].join("/");this.setParam("action","TEMPLATE").setParam("dates",n).setParam("text",this.title).setParam("details",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.recurrence&&this.setParam("recur",`RRULE:${T.getRrule(this.recurrence)}`),this.attendees.length>0&&this.setParam("add",E.toMailtoList(this.attendees).join(","))});o(this,"render",()=>{const t=O.GOOGLE,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class vt extends R{constructor(t){super(t);o(this,"setInitialParams",()=>{this.setParam("v","60").setParam("title",this.title).setParam("desc",this.description).setParam("in_loc",this.location),this.setTimeParams(),this.attendees.length>0&&this.setParam("inv_list",E.toMailtoList(this.attendees).join(","))});o(this,"setTimeParams",()=>{this.isAllDay?this.setParam("dur","allday").setParam("st",u.formatDateNoUtc(this.start,m.DATE)):(this.setParam("st",u.formatDateNoUtc(this.start,m.NO_UTC_FULL)),u.getHoursDiff(this.start.getTime(),this.end.getTime())>99?this.setParam("et",u.formatDateNoUtc(this.end,m.NO_UTC_FULL)):this.setParam("dur",u.getDuration(this.start.getTime(),this.end.getTime())))});o(this,"render",()=>{const t=O.YAHOO,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class Lt extends R{constructor(t){super(t);o(this,"baseUrl",O.OUTLOOK);o(this,"setInitialParams",()=>{let t=m.OUTLOOK_DATE;this.isAllDay||(t+=m.OUTLOOK_TIME),this.setParam("rru","addevent").setParam("path","/calendar/action/compose").setParam("startdt",u.formatDate(this.start,t)).setParam("enddt",u.formatDate(this.end,t)).setParam("subject",this.title).setParam("body",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.attendees.length>0&&this.setParam("to",E.toMailtoList(this.attendees).join(","))});o(this,"setHost",t=>(["live","office"].includes(t)&&(this.baseUrl=O.OUTLOOK.replace("{{host}}",t)),this));o(this,"render",()=>{const t=E.toQueryString(this.params);return`${this.baseUrl}?${t}`});this.setInitialParams(),this.setHost("live")}}class Pt extends R{constructor(t){super(t);o(this,"additionalEvents",[]);o(this,"properties",[]);o(this,"meta",{});o(this,"setInitialParams",()=>{this.setMeta("UID",T.getUid()).setMeta("DTSTAMP",u.getTimeCreated()).addProperty("CLASS","PUBLIC").addProperty("DESCRIPTION",T.formatText(this.description)).addProperty("LOCATION",T.formatText(this.location)).addProperty("SUMMARY",T.formatText(this.title)).addProperty("TRANSP","TRANSPARENT"),this.isAllDay?this.addProperty("DTSTART;VALUE=DATE",u.formatDateNoUtc(this.start,m.DATE)).addProperty("DTEND;VALUE=DATE",u.formatDateNoUtc(u.incrementDate(this.start,1),m.DATE)):this.addProperty("DTSTART",u.formatDate(this.start,m.FULL)).addProperty("DTEND",u.formatDate(this.end,m.FULL)),this.recurrence&&this.addProperty("RRULE",T.getRrule(this.recurrence)),this.attendees.length>0&&this.attendees.forEach(({email:t,name:n,icsOptions:r={}})=>{const f=this.getAttendeeParams(r,n),h=`MAILTO:${t}`;this.addProperty(f,h)})});o(this,"getAttendeeParams",(t,n)=>{const r={};return n&&(r.CN=n),t.delegatedFrom&&(r["DELEGATED-FROM"]=t.delegatedFrom),t.partStat&&(r.PARTSTAT=t.partStat),t.role&&(r.ROLE=t.role),t.sentBy&&(r["SENT-BY"]=t.sentBy),r.RSVP=t.rsvp?"TRUE":"FALSE",`ATTENDEE;${E.toParamString(r,";")}`});o(this,"getAlarmDuration",t=>{const n=[`${t.weeks}W`,`${t.days}D`,`${t.hours}H`,`${t.minutes}M`,`${t.seconds}S`].filter(r=>/^[0-9]+[A-Z]$/.exec(r));return n.unshift(t.after?"PT":"-PT"),n.join("")});o(this,"getMeta",()=>Object.keys(this.meta).map(t=>`${t}:${this.meta[t]}`));o(this,"setMeta",(t,n)=>(this.meta[t]=n,this));o(this,"addEvent",t=>(this.additionalEvents.push(t),this));o(this,"addProperty",(t,n)=>{if(typeof n=="object"){this.properties.push(`BEGIN:${t}`);for(const r in n)this.addProperty(r,n[r]);this.properties.push(`END:${t}`)}else this.properties.push(`${t}:${n.toString()}`);return this});o(this,"addAlarm",t=>{const n={ACTION:t.action};if(t.description&&(n.DESCRIPTION=T.formatText(t.description)),t.summary&&(n.SUMMARY=T.formatText(t.summary)),t.duration&&(n.DURATION=this.getAlarmDuration(t.duration)),t.repeat&&(n.REPEAT=t.repeat),t.attach){const r=t.attach.params?`ATTACH;${t.attach.params}`:"ATTACH";n[r]=t.attach.url}return t.trigger instanceof Date?n["TRIGGER;VALUE=DATE-TIME"]=u.formatDate(t.trigger,m.FULL):n.TRIGGER=this.getAlarmDuration(t.trigger),this.addProperty("VALARM",n)});o(this,"download",t=>{T.download(t||T.getFileName(this.title),this.render())});o(this,"render",()=>["BEGIN:VCALENDAR","VERSION:2.0",...[this,...this.additionalEvents].reduce((r,f)=>[...r,"BEGIN:VEVENT",...f.properties,...f.getMeta(),"END:VEVENT"],[]),`PRODID:${T.getProdId()}`,"END:VCALENDAR"].join(`
`));this.setInitialParams()}}const Ut=Z({name:"Generator",components:{ConfigObject:K,Basics:q,Dates:Q,Recurrence:W},setup(){const e=S({start:new Date,location:"",title:"",description:"",recurrence:{}}),s=S(!0),t=S(!0),n={Google:yt,"Yahoo!":vt,Outlook:Lt},r=I(()=>Object.keys(n).reduce((A,D)=>({...A,[D]:new n[D](e.value).render()}),{})),f=I(()=>new Pt(e.value));function h(){e.value.recurrence=t.value?{}:void 0}return{isAllDay:s,isRecurring:t,model:e,serviceUrls:r,ics:f,onRecurrenceChange:h}}});const Ot=d("h2",null,"Event Details",-1),Rt=d("label",{for:"isAllDay"},"This is an all-day event",-1),wt=d("h2",null,"Recurrence",-1),Mt=d("label",{for:"recurs"},"This event repeats",-1),St=d("h2",null,"Result",-1),Yt=d("h3",null,"Calendar Service Links",-1),bt=["href"],Ct=d("hr",null,null,-1),Nt=d("h3",null,"iCalendar",-1),_t=d("code",null,".ics",-1),It={class:"language-typescript"},$t={class:"language-json"},jt=d("hr",null,null,-1),Ft=d("h3",null,"Datebook Config Object",-1);function kt(e,s,t,n,r,f){const h=v("basics"),A=v("dates"),D=v("recurrence"),a=v("external-link-icon"),i=v("config-object");return P(),Y("div",null,[Ot,U(h,{modelValue:e.model,"onUpdate:modelValue":s[0]||(s[0]=c=>e.model=c)},null,8,["modelValue"]),U(A,{modelValue:e.model,"onUpdate:modelValue":s[1]||(s[1]=c=>e.model=c),isAllDay:e.isAllDay},null,8,["modelValue","isAllDay"]),$(d("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>e.isAllDay=c),type:"checkbox",id:"isAllDay",value:"true"},null,512),[[j,e.isAllDay]]),Rt,d("div",null,[wt,$(d("input",{"onUpdate:modelValue":s[3]||(s[3]=c=>e.isRecurring=c),type:"checkbox",id:"recurs",onChange:s[4]||(s[4]=(...c)=>e.onRecurrenceChange&&e.onRecurrenceChange(...c))},null,544),[[j,e.isRecurring]]),Mt]),e.model.recurrence?(P(),z(D,{key:0,modelValue:e.model.recurrence,"onUpdate:modelValue":s[5]||(s[5]=c=>e.model.recurrence=c),isAllDay:e.isAllDay},null,8,["modelValue","isAllDay"])):J("v-if",!0),St,d("div",null,[Yt,d("ul",null,[(P(!0),Y(tt,null,et(e.serviceUrls,(c,l)=>(P(),Y("li",{key:l},[d("a",{href:c,target:"_blank"},[b(F(l)+" Calendar ",1),U(a)],8,bt)]))),128))])]),Ct,d("div",null,[Nt,d("a",{onClick:s[6]||(s[6]=c=>e.ics.download())},[b(" Download "),_t,b(" file ↓ ")]),d("div",It,[d("pre",$t,F(e.ics.render()),1)])]),jt,d("div",null,[Ft,U(i,{value:e.model},null,8,["value"])])])}const zt=X(Ut,[["render",kt],["__file","Generator.vue"]]);export{zt as default};
